# üìò Data Dictionary & System Architecture

This document defines the data types, sources, and storage schemas used in the Central Brain.

## 1. Data Sources (Inputs)

### A. Local Sensor Data (The "Reality")
* **Source:** RPi4 (Node 1) via RTL-SDR.
* **Protocol:** Beast Binary (Port 30005).
* **Content:** Unencrypted ADS-B broadcasts (Mode S) directly from aircraft.

### B. External Reference (The "Validation")
* **Source:** OpenSky Network API.
* **Content:** Global crowd-sourced state vectors used to validate local signal integrity.

---

## 2. Database Schema (InfluxDB)

All time-series data is stored in the **`readsb`** database.

### ‚úàÔ∏è Measurement: `flight_ops` (The "Brain" Data)
*This table contains the **processed** logic, physics checks, and runway analysis generated by your Watchdog script.*

| Field Key | Type | Description |
| :--- | :--- | :--- |
| **`lat`**, **`lon`** | Float | Aircraft Position (WGS84). |
| **`alt_ft`** | Integer | Barometric Altitude (Feet). |
| **`speed_kts`** | Integer | Ground Speed (Knots). |
| **`vertical_rate`** | Integer | Rate of Climb/Descent (ft/min). |
| **`bearing_deg`** | Float | Track Angle (0-360). |
| **`distance_km`** | Float | Calculated distance from your sensor. |
| **`is_spoofed`** | Integer | **0** = Normal, **1** = Anomaly Detected. |
| **`event_score`** | Integer | Severity of anomaly (used for alerts). |

### üì° Measurement: `aircraft` (The "Raw" Data)
*This table contains the raw telemetry dump from the Readsb container.*

| Field Key | Description |
| :--- | :--- |
| **`Alt`**, **`GAlt`** | Barometric vs Geometric Altitude. |
| **`Lat`**, **`Long`** | Raw coordinates. |
| **`Sig`** | Signal Level (RSSI) - Useful for coverage mapping. |
| **`Spd`**, **`Trak`** | Speed and Heading. |
| **`Squawk`** | Transponder Code. |

### üõ°Ô∏è Measurement: `integrity_check`
*Specific metrics used to debug spoofing accuracy.*

| Field Key | Description |
| :--- | :--- |
| **`lat_error`** | Difference between Local Lat vs OpenSky Lat. |
| **`lon_error`** | Difference between Local Lon vs OpenSky Lon. |

---

## 3. Alerting Data (MQTT)

Critical security events are published to the `aviation/alerts` topic.

**Example Payload:**
```json
{
  "type": "GO-AROUND",
  "timestamp": "2025-11-23T14:30:00Z",
  "details": "FIN123 at 22L (Alt: 1500ft, V-Rate: +2000fpm)"
}
```
